# 88. readObject 메서드는 방어적으로 작성하라

readObject는 실질적으로 또 다른 public 생성자다.  
따라서 다른 생성자와 똑같은 수준으로 주의를 기울여야 한다.  
보통의 생성자처럼 readObject 메서드에서도 인수가 유효한지 검사해야 하고 필요하다면 매개변수를 방어적으로 복사해야 한다.

readObject는 바이트 스트림을 받는 생성자라 할 수 있다.  
보통의 경우 바이트 스트림은 정상적으로 생성된 인스턴스를 직렬화해 만들어진다.  
하지만 불변식을 깨뜨릴 의도로 임의 생성한 바이트 스트림을 건네면 문제가 생긴다.  
정상적인 생성자로는 만들어낼 수 없는 객체를 생성하기 때문이다.

안전한 readObject 메서드를 작성하는 지침이다.

- private이어야 하는 객체 참조 피드는 각 필드가 가리키는 객체를 방어적으로 복사하라. 불변 클래스 내의 가변 요소가 여기 속한다.
- 모든 불변식을 검사하여 어긋나는 게 발견되면 InvalidObjectException을 던진다. 방어적 복사 다음에는 반드시 불변식 검사가 뒤따라야 한다.
- 역직렬화 후 객체 그래프 전체의 유효성을 검사해야 한다면 ObjectInputValidation 인터페이스를 사용하라.
- 직접적이든 간접적이든, 재정의할 수 있는 메서드는 호출하지 말자.