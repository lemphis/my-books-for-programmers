# 49. 매개변수가 유효한지 검사하라

메서드와 생성자 대부분은 입력 매개변수의 값이 특정 조건을 만족하기를 바란다.  
이런 제약은 반드시 문서화해야 하며 메서드 몸체가 시작되기 전에 검사해야 한다.

매개변수 검사에 실패하면 실패 원자성(failure atomicity)을 어기는 결과를 낳을 수 있다.

**자바 7에 추가된 java.util.Objects.requireNonNull 메서드는 유연하고 사용하기도 편하니, 더 이상 null 검사를 수동으로 하지 않아도 된다.**

public이 아닌 메서드라면 단언문(assert)을 사용해 매개변수 유효성을 검증할 수 있다.

```java
class Demo {
    public static void sort(long[] a, int offset, int length) {
        assert a != null;
        assert offset >= 0 && offset <= a.length;
        assert length >= 0 && length <= a.length - offset;
    }
}
```

이 단언문들은 자신이 단언한 조건이 무조건 참이라고 선언하는 것이다.  
단언문은 몇 가지 면에서 일반적인 유효성 검사와 다르다.

1. 실패하면 AssertionError를 던진다.
2. 런타임에 아무런 효과도, 성능 저하도 없다. (단, java를 실행할 때 명령줄에서 -ea 혹은 --enableassertions 플래그 설정을 하면 런타임에 영향을 준다)

메서드가 직접 사용하지는 않으나 나중에 쓰기 위해 저장하는 매개변수는 특히 더 신경 써서 검사해야 한다.  
생성자는 "나중에 쓰려고 저장하는 매개변수의 유효성을 검사하라"는 원칙의 특수한 사례다.  
생성자 매개변수의 유효성 검사는 클래스 불변식을 어기는 객체가 만들어지지 않게 하는 데 꼭 필요하다.

메서드 몸체 실행 전에 매개변수 유효성을 검사해야 한다는 규칙에도 예외는 있다.

1. 유효성 검사 비용이 지나치게 높을 때
2. 계산 과정에서 암묵적으로 검사가 수행될 때

메서드나 생성자를 작설할 때면 그 매개변수들에 어떤 제약이 있을지 생각해야 한다.  
그 제약들을 문서화하고 메서드 코드 시작 부분에서 명시적으로 검사해야 한다.