# 2.1 리팩토링은 무엇인가

이 책에서의 '리팩토링' 용어는 문맥에 따라 두 가지 의미로 정의된다.  
정의가 두 가지라서 꽤 신경 쓰이겠지만, 현실에서는 두 가지 의미로 쓰이기 때문에 알아둬야 한다.

1. 겉으로 드러나는 기능은 그대로 둔 채, 알아보기 쉽고 수정하기 간편하게 소프트웨어 내부를 수정하는 작업 (명사 정의)
2. 리팩토링 기법을 연달아 적용해서 겉으로 드러나는 기능은 그대로 둔 채 소프트웨어 구조를 변경한다 (동사 정의)

리팩토링은 코드 효율성이 높아지고 구조도 체계화된다는 점을 생각해 볼 때 단순한 코드 정리보다는 더 포괄적인 개념이라고 할 수 있다.

위의 정의에서 강조할 내용은 두 가지다.

1. 리팩토링의 목적은 소프트웨어를 더 이해하기 쉽고 수정하기 쉽게 만드는 것
2. 리팩토링은 겉으로 드러나는 소프트웨어 기능에 영향을 주지 않음

## 모자 두 개

앞의 두 번째 주요 내용은 켄트 벡의 '모자 두 개' 비유법을 연상하게 한다.  
소프트웨어 개발에 리팩토링을 적용할 때 **기능 추가와 리팩토링이라는 별개의 두 작업에 시간을 분배**해야 한다.  
**기능을 추가할 땐 코드를 수정하지 말고 기능만 추가**해야 한다.  
진행 상태를 파악하려면 테스트를 추가하고 그 테스트들이 제대로 되는지 알아내면 된다.  
**리팩토링을 할 때는 코드를 추가하지 말고 구조 개선**만 해야 한다.  
앞서 실수한 게 없다면 테스트는 전혀 추가하지 말고 오로지 코드 구조만 수정해야 한다.  
추가로 인터페이스가 변경되어 그에 맞게 코드를 고치는 것이 불가피할 땐 테스트만 변경해야 한다.

소프트웨어를 개발하다 보면 이렇게 기능 추가 모자와 리팩토링 모자를 자주 바꿔 쓰게 된다.  
처음에 새 기능을 추가하다가, 그 코드의 구조를 바꾸면 작업이 훨씬 쉬워지겠다는 생각이 들어 작업을 멈추고 잠시 리팩토링 작업으로 전환한 후 구조 변경이 끝나면 다시 새 기능 추가 작업으로 전환하고, 새 기능이 제대로 돌아가면 그 기능을 이해하기 어려운 구조로 작성했다는 생각이 들어 다시 리팩토링 작업으로 전환하는 식으로 두 모자를 바꿔쓰게 된다.  
이 모든 작업 과정은 10분이면 끝날 만큼 간단할 수도 있지만, 이 시간 동안 **각 작업이 완료될 때까지는 반드시 본인이 현재 하고 있는 작업의 일관성을 유지**해야 한다.
