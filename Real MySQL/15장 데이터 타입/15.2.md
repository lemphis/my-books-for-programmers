# 15.2 숫자

숫자를 저장하는 타입은 크게 값의 정확도에 따라 참값(Exact value data type)과 근삿값 타입으로 나눌 수 있다.

- 참값
  - 소수점 이하 값의 유무에 관계없이 정확히 그 값을 그대로 유지하는 것
  - INTEGER를 포함해 INT로 끝나는 타입과 DECIMAL이 있음
- 근삿값
  - 흔히 부동 소수점이라고 불리는 값을 의미함
  - 처음 칼럼에 저장된 값과 조회된 값이 정확하게 일치하지 않고 최대한 비슷한 값을 관리하는 것
  - FLOAT, DOUBLE이 있음

또한 값이 저장되는 포맷에 따라 십진 표기법(DECIMAL)과 이진 표기법으로 나눠볼 수 있다.

- 십진 표기법
  - 숫자 값의 각 자릿값을 표현하기 위해 4비트나 한 바이트를 사용해서 표기하는 방법
  - 우리가 흔히 이야기하는 십진수가 아니라 디스크나 메모리에 십진 표기법으로 저장된다는 것을 의미함
  - MySQL에서는 DECIMAL만 십진 표기법을 사용
  - DECIMAL 타입은 금액(돈)처럼 정확하게 소수점까지 관리되어야 하는 값을 저장할 때 사용하며, 65자리 숫자까지 표현할 수 있으므로 BIGINT로도 저장할 수 없는 값을 저장할 때 사용
- 이진 표기법
  - 흔히 프로그래밍 언어에서 사용하는 정수나 실수 타입을 의미함
  - 한 바이트로 한자리 또는 두 자리 숫자만 저장하는 것이 아니라 256까지의 숫자(양수만 저장한다고 가정할 경우)를 저장할 수 있는 특징이 있기 때문에 숫자 값을 적은 메모리나 디스크 공간에 저장할 수 있음
  - INTEGER나 BIGINT 등 대부분의 숫자 타입이 사용

DBMS에서는 근삿값은 저장할 때와 조회할 때의 값이 정확히 일치하지 않고, 유효 자릿수를 넘어서는 소수점 이하의 값은 계속 바뀔 수 있으므로 복제에서도 마스터와 슬레이브에서 차이가 발생할 수도 있다.  
MySQL에서 FLOAT나 DOUBLE과 같은 부동 소수점 타입은 잘 사용하지 않는다.  
또한 십진 표기법을 사용하는 DECIMAL 타입은 이진 표기법을 사용하는 타입보다 저장 공간을 2배 이상을 필요로 한다.  
매우 큰 숫자 값이나 고정 소수점을 저장해야 하는 게 아니라면 일반적으로 INTEGER나 BIGINT 타입을 자주 사용하는 편이다.

## 15.2.1 정수

DECIMAL 타입을 제외하고 정수를 저장하는 데 사용할 수 있는 데이터 타입으로는 5가지가 있다.

| 타입      | 필요 저장 공간 | 저장 가능한 수의 범위 (Unsigned)                                    |
| :-------- | :------------- | :------------------------------------------------------------------ |
| TINYINT   | 1바이트        | -128\~127 (0\~255)                                                  |
| SMALLINT  | 2바이트        | -32768\~32767 (0\~65535)                                            |
| MEDIUMINT | 3바이트        | -8388608\~8388607 (0\~16777215)                                     |
| INTEGER   | 4바이트        | -2147483648\~2147483647 (0\~4294967295)                             |
| BIGINT    | 8바이트        | -9223372036854775808\~9223372036854775807 (0\~18446744073709551615) |

정수 타입은 UNSIGNED라는 칼럼 옵션을 사용할 수 있다.  
정수 칼럼을 생성할 때 UNSIGNED 옵션을 명시하지 않으면 기본적으로 음수와 양수를 동시에 저장할 수 있는 숫자 타입(SIGNED)이 된다.  
AUTO_INCREMENT 칼럼과 같이 음수가 될 수 없는 값을 저장하는 칼럼에 UNSIGNED 옵션을 명시하면 적은 데이터 공간으로 더 큰 값을 저장할 수 있다.

## 15.2.2 부동 소수점

MySQL에서는 부동 소수점을 저장하기 위해 FLOAT와 DOUBLE 타입을 사용할 수 있다.  
부동 소수점은 근삿값을 저장하는 방식이라서 동등 비교(Equals)는 사용할 수 없다.

- FLOAT
  - 일반적으로 정밀도를 명시하지 않으면 4바이트를 사용해 유효 자릿수를 8개까지 유지
  - 정밀도가 명시된 경우 최대 8바이트까지 저장 공간을 사용할 수 있음
- DOUBLE
  - 8바이트의 저장 공간을 필요로 하며 최대 유효 자릿수 16개까지 사용

만약 부동 소수점 값을 저장해야 한다면 유효 소수점의 자릿수만큼 10을 곱해서 정수로 만들어 그 값을 정수 타입의 칼럼에 저장하는 방법도 생각해 볼 수 있다.

## 15.2.3 DECIMAL

소수점의 위치가 가변적이지 않은 고정 소수점 타입을 위해 DECIMAL 타입을 제공한다.  
비슷한 성격의 타입으로 NUMERIC 타입이 있으며, MySQL에서는 NUMERIC과 DECIMAL은 내부적으로 같은 방식으로 처리되므로 동의어 정도로 이해하면 된다.

DECIMAL 타입은 숫자 하나를 저장하는 데 1/2바이트가 필요하므로 저장하는 (숫자의 자릿수)/2의 결괏값을 올림 처리한 만큼의 바이트 수가 필요하다.

소수가 아닌 정숫값을 관리하기 위해 DECIMAL이나 NUMERIC 타입을 사용하는 것은 성능상으로나 공간 사용 면에서 좋지 않다.  
단순히 정수를 관리하고자 한다면 INTEGER나 BIGINT를 사용하는 것이 좋다.

## 15.2.4 정수 타입의 칼럼을 생성할 때의 주의 사항

부동 소수점이나 DECIMAL 타입을 이용해 칼럼을 정의할 때는 타입의 이름 뒤에 괄호로 정밀도를 표시하는 것이 일반적이다.  
아래는 이에 대한 예시이다.

- DECIMAL(20, 5)
  - 정수부 15(=20-5)자리
  - 소수부 5자리
- DECIMAL(20)
  - 정수부 20자리
  - 소수부 없음

FLOAT나 DOUBLE 타입은 저장 공간의 크기가 고정형이므로 정밀도를 조절한다고 해서 저장 공간의 크기가 바뀌는 것은 아니다.  
하지만 DECIMAL 타입은 저장 공간의 크기가 가변적인 데이터 타입이어서 DECIMAL 타입에 사용되는 정밀도는 저장 가능한 자릿수를 결정함과 동시에 저장 공간의 크기까지 제한한다.

부동 소수점(FLOAT, DOUBLE)이나 고정 소수점(DECIMAL)이 아닌, 정수 타입을 생성할 때도 똑같이 BIGINT(10)와 같이 괄호로 값의 크기를 명시할 수 있는 문법을 지원한다.  
여기서 자릿수라는 것은 화면에 표시할 자릿수를 의미하는 것이며, 이는 ZEROFILL을 얼마나 할지를 의미하는 자릿수다.  
정수 타입 뒤의 길이 지정은 ZEROFILL 옵션이 없으면 아무런 의미가 없다.  
ZEROFILL 옵션이 사용되면 자동으로 그 칼럼의 타입은 UNSIGNED 타입이 되어 버리기 때문에 주의해야 한다.

## 15.2.5 자동 증가(AUTO_INCREMENT) 옵션 사용

테이블의 프라이머리 키를 구성하는 칼럼의 크기가 너무 크거나 프라이머리 키로 사용할 만한 칼럼이 없을 때는 숫자 타입의 칼럼에 자동 증가 옵션을 사용해 인조 키를 생성할 수 있다.

AUTO_INCREMENT 옵션을 사용한 칼럼은 반드시 그 테이블에서 프라이머리 키나 유니크 키의 일부로 정의해야 한다.  
그런데 프라이머리 키나 유니크 키가 여러 개의 칼럼으로 구성되면 AUTO_INCREMENT 속성의 칼럼의 값이 증가하는 패턴이 MyISAM 스토리지 엔진과 InnoDB 스토리지 엔진에서 각각 달라진다.

- MyISAM
  - 자동 증가 옵션이 사용된 칼럼이 프라이머리 키나 유니크 키의 아무 위치에나 사용될 수 있음
- InnoDB
  - 반드시 AUTO_INCREMENT 칼럼이 프라이머리 키 또는 유니크 키 중 적어도 하나의 인덱스에서는 제일 앞에 위치해야 함
