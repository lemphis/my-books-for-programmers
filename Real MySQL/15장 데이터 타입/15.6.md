# 15.6 공간(Spatial) 데이터 타입

MySQL에서는 공간 데이터 관리를 위해 OpenGIS의 일부 기능을 지원한다.  
공간 데이터라는 것은 요즘 흔히 사용되는 GPS를 이용한 위치 정보를 포함해 모든 좌표 형식의 데이터를 관리할 수 있는 개념이다.  
MySQL의 공간 정보 관리 기능은 라인이나 점 또는 다각형과 같은 정보를 저장할 수 있는 데이터 타입과, 공간 데이터의 연산을 위한 확장 함수를 제공한다.  
또한 공간 데이터의 빠른 검색을 위한 인덱싱 알고리즘(R-Tree)도 제공한다.

MySQL에서 제공하는 공간 정보 저장용 데이터 타입은 GEOMETRY, POINT, LINESTRING, POLYGON 등이 있으며, 이 타입들은 대부분 하나의 단위 정보를 저장할 수 있다.  
부가적으로 MULTIPOINT, MULTILINESTRING, MULTIPOLYGON, GEOMETRYCOLLECTION 타입과 같이 여러 개의 정보를 저장할 수 있는 타입도 지원된다.

## 15.6.1 POINT 타입

공간 데이터 타입 가운데 가장 기본적인 데이터 타입으로 X와 Y의 좌표로만 구성된 하나의 점 정보를 저장할 수 있는 데이터 타입이다.  
POINT 타입에 값을 저장하려면 다음과 같이 좌표(x, y)를 POINT 타입으로 변환하는 함수를 이용해 값을 변환해야 한다.

- POINT(x, y)
  - 숫자 값으로 된 두 개의 인자(X좌표와 Y좌표)를 이용해 POINT 타입의 데이터를 생성하는 방법
- GeomFromText('POINT(x y)')
  - 문자열로 표현된 좌표 값을 이용해 POINT 데이터를 생성하는 방법
  - 하나의 문자열만을 인자로 사용함
  - 좌표를 표현하는 좌표 값 사이에는 구분자가 없어야 함
  - 인자로 사용되는 문자열은 WKT(Well known text)라고 하는 지정된 규칙에 맞게 작성해야 함

MySQL의 공간 데이터 타입은 모두 이진 값으로 저장된다.  
공간 데이터 값을 조회할 때는 AsText() 함수를 이용해 지정된 문자열 포맷(Well known text)으로 조회하거나 X() 또는 Y() 함수를 이용해 위치 정보의 X와 Y좌표를 조회해 볼 수 있다.

## 15.6.2 LINESTRING 타입

LINESTRING 타입은 하나의 직선뿐 아니라 여러 개의 꺾임이 있는 연결된 선도 모두 저장할 수 있다.  
POINT 타입과 마찬가지로 LINESTRING 타입의 데이터를 생성하는 방법도 다음과 같이 두 가지다.

- LINESTRING()
  - 라인의 시작 점(POINT)과 중간의 꺾임이 발생하는 점(POINT)을 연속해서 나열하고 마지막에는 종료 점(POINT)을 명시
  - 각 점은 POINT() 함수를 이용해 표현
- LineStringFromText()
  - WKT 문자열의 각 점 좌표는 콤마로 구분하되 각 점의 X좌표와 Y좌표는 공백으로 구분

## 15.6.3 POLYGON 타입

POLYGON 타입은 다각형을 저장할 수 있는 데이터 타입으로, 여기서 다각형이란 반드시 시작 지점과 종료 지점이 일치하는 닫힌 도형을 의미한다.  
또한 POLYGON 타입은 내부가 채워진 다각형뿐 아니라 내부가 빈 도넛 모양의 다각형도 표현할 수 있다.  
POLYGON 타입의 값을 생성하는 방법 또한 POINT와 같이 두 가지 방법이 있지만 좌표를 이용하는 POLYGON() 함수는 POINT와 LINESTRING() 함수를 여러 번 이용해야 하므로 상당히 복잡해진다.  
그래서 WKT 문자열을 이용해 POLYGON 타입의 데이터를 생성하는 방법이 더 가독성이 높고 작성하기도 쉽다.

## 15.6.4 GEOMETRY 타입

GEOMETRY 타입은 지금까지 소개한 데이터 타입을 모두 포함할 수 있는 슈퍼 타입이다.  
GIS처럼 다양한 공간 정보를 저장해야 하는 칼럼이 필요할 때는 단순히 점(위치)이나 라인뿐 아니라 복잡하고 다양한 다각형 데이터가 담길 것이다.  
이때 GEOMETRY 타입을 이용하면 된다.
