# 14.1 논리 모델링

ERD의 생명은 가독성이다.  
최대한 간결하게 표현해서 다른 사람이 그림만 봐도 그 업무를 어느 정도까지는 이해할 수 있게 하는 것이 목적이기 때문이다.

## 14.1.1 모델링 용어

ERD 상에 표현되는 오브젝트는 논리 모델, 물리 모델에서 사용하는 이름을 하나씩 가지고 있다.

| 논리 모델                   | 물리 모델                | 비고                                                                                                    |
| --------------------------- | ------------------------ | ------------------------------------------------------------------------------------------------------- |
| 주제 영역(Subject area)     | 주제 영역(Subject area)  |                                                                                                         |
| 엔터티(Entity)              | 테이블(Table)            | 논리 모델과 물리 모델에서 하나의 오브젝트(엔터티 또는 테이블)는 항상 1:1의 관계가 아닐 수도 있다.       |
| 속성, 어트리뷰트(Attribure) | 칼럼(Column)             | 일반적으로는 논리 모델인지 물리 모델인지 별도 구분 없이 사용하므로 둘 다 같은 의미로 인색해도 무방하다. |
| 관계, 릴레이션(Relation)    | 관계, 릴레이션(Relation) | 관계 또는 릴레이션이라는 용어는 논리 물리 구분 없이 모두 공통적으로 사용한다.                           |
| 키 그룹(Key group)          | 인덱스(Index)            | 키 그룹이라는 표현은 잘 사용하지 않고 논리나 물리 모델 전부 인덱스라고 표현한다.                        |

## 14.1.2 용어집

ERD를 그리기 이전 또는 이후에(적어도 코드 작성을 시작하기 전에) **모든 주요 단어에 대해 명확히 그 범위를 제한**하는 작업을 한 번씩 진행하길 적극 권장한다.  
특히나 주요 용어에 대해서는 모든 가능한 경우의 관련 단어를 나열하고, 그 의미를 포함할지 뺄지를 체크하자.  
그리고 그에 걸맞는 이름을 부여하고, 그에 맞춰 물리 모델에서 데이터 타입이나 기타 옵션을 적용하는 것이 좋다.

## 14.1.3 엔터티

`엔터티`는 객체지향 개발 언어의 클래스와 동급의 의미다.  
또한 엔터티는 2개 이상의 속성을 가지고 1개 이상의 레코드를 가지는 것이 일반적이다.  
우리가 **일반적으로 테이블이라고 칭하는 개체**가 바로 엔터티이지만 사실 엔터티와 테이블은 항상 1:1의 관계로 구현되는 것은 아니다.  
2개 이상의 엔터티가 물리 모델링 단계에서 통합되기도 하고, 하나의 엔터티가 여러 개의 물리적 테이블로 구현되기도 한다.  
엔터티를 도출할 때 가장 중요한 것은 **용어의 정의**다.  
해당 용어가 의미하는 범위가 어디까지인지를 명확히 하고 그에 걸맞은 이름을 부여하는 것이다.

### 엔터티의 종류와 표현 방법

엔터티는 ERD에서 3개의 영역으로 나뉜 사각형 상자로 표시한다.

- 사각형 상자 외부 최상단: 엔터티의 이름
- 사각형 상자 내부 상단: 엔터티의 식별자(프라이머리 키)를 구성하는 속성
- 사각형 상자 내부 하단: 식별자가 아닌 일반 속성

엔터티는 업무의 흐름이나 중요도에 따라 크게 세 가지로 구분할 수 있다.

- 키 엔터티
  - 관리 대상 데이터 중에서 가장 최상위에 존재하는 엔터티
  - 일반적으로 메인 엔터티와 액션 엔터티를 만들어 내는 부모 역할
  - 일반적으로 현실에 존재하는 객체를 표현하는 것들이 많음
  - ERD에서 각이 진 사각형으로 표시
- 메인 엔터티
  - 액션 엔터티 중에서 서비스에서 상당히 중요한 역할을 하는 엔티티
- 액션 엔터티
  - 키 엔터티 간의 작용(관계)으로 만들어지는 엔터티
  - ERD에서 원형의 동그란 사각형으로 표시

### 엔터티의 작명

엔터티의 이름은 복수형 표현을 사용하지 않고 별도의 수식어가 없는 단순 또는 복합 명사 형태를 사용한다.  
하나의 엔터티가 여러 개의 엔터티로 분리되어 모델링됐을 때 주로 엔터티의 이름에 수식어가 사용된다.

## 14.1.4 어트리뷰트(속성)

`어트리뷰트`란 더는 분리될 수 없는 **최소의 데이터 보관 단위**다.  
하나의 엔터티 내에서 다른 어트리뷰트와 비교했을 때 독자적인 성질을 가지는 것이어야 한다.  
또한 어트리뷰트는 가공하지 않은 그대로의 값이라는 의미도 함께 포함하고 있다.

어트리뷰트의 이름은 반드시 의미가 명확한 명칭을 부여해야 한다.  
또한 어트리뷰트는 항상 최소의 데이터 단위이므로 항상 하나의 값만 가져야 한다.

### 어트리뷰트의 원자성

어트리뷰트의 원자성에 대해 정리하면 다음과 같다.

- 하나의 어트리뷰트는 해당 업무 요건에 맞게 최소 단위의 값 하나만 가져야 한다.
- 하나의 어트리뷰트에 복수형으로 값을 저장해서는 안 된다.

위의 두 가지 모두 물리 모델 단계에서는 성능을 위해 조금씩 위배해서 설계할 수도 있지만, 논리 모델에서는 이러한 원자성을 위배하는 추출 칼럼은 고려하지 않는 것이 좋다.

### 어트리뷰트의 작명

어트리뷰트의 이름을 결정하는 것은 타협과 원칙의 싸움이며, 결국 타협과 원칙의 결합으로 속성명이 결정된다.  
속성 이름은 원칙을 최대한 준수하려고 노력해야 ERD의 가독성이 높아지고 커뮤니케이션을 위한 기본 자료로 의미를 갖기 때문이다.

어트리뷰트의 이름은 반드시 **한정자 + 값**을 표현하는 것이 가장 이상적이다.  
그래도 의미 전달이 부족하다면 추가 한정자를 더 붙여야 한다.  
그런데 어트리뷰트의 이름이 너무 길어지면 물리 모델로 넘어가면서 칼럼의 이름을 부여하는 것이 까다로워질 수 있으므로 단어 2~4개 정도로 적절히 결합해서 만드는 것이 좋다.

엔터티와 어트리뷰트의 이름을 하나씩 작성하다 보면 일관성을 유지하지 못할 때가 상당히 많다.  
"표준 단어"는 ERD에서 사용하는 개체의 이름을 표준화하는 데 사용한다.  
표준 단어가 준비돼 있다면 모델링 작업이 상당히 빠르게 진행될 수 있다.  
표준 단어를 사용하면 어트리뷰트의 이름을 물리 모델의 칼럼 이름으로 변환하는 작업을 자동화할 수도 있다.

## 14.1.5 식별자(프라이머리 키)

프라이머리 키 또는 식별자는 **하나의 엔터티에서 개별 레코드를 식별할 수 있는 어트리뷰트의 조합**을 의미한다.  
식별자는 본질 식별자(또는 의미상의 식별자)와 실질 식별자라는 말로 나눌 수 있다.

- 본질 식별자
  - 엔터티의 레코드가 생성되는 조건을 알려주는 식별자
- 실질 식별자
  - 실제로 사용되는 식별자
  - 본질 식별자가 실질 식별자가 될 수도 있고, 인위적으로 생성한 인조 식별자가 실질 식별자가 될 수도 있음

만약 인조 식별자를 도입했다면 본질 식별자는 프라이머리 키로 생성되지 못하고 대체 키(유니크 인덱스)로 생성하는데, 꼭 유일성이 보장되지 않아도 되고 업무상 필요하지 않다면 단순히 중복이 허용되는 인덱스로 생성하기도 한다.
