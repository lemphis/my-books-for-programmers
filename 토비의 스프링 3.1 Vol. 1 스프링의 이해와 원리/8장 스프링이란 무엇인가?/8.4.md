# 8.4 스프링의 기술

## 8.4.1 제어의 역전(IoC) / 의존 관계 주입(DI)

### DI의 활용 방법

아래는 좀 더 구체적인 DI의 활용 방식이다.

- 핵심 기능 변경
  - DI의 가장 대표적인 적용 방법은 의존 대상의 구현을 바꾸는 것
  - 전략 패턴
- 핵심 기능의 동적인 변경
  - 애플리케이션이 동작하는 중간에 그 의존 대상을 다이내믹하게 변경 가능
- 부가 기능의 추가
  - 핵심 기능은 그대로 둔 채 부가 기능 추가 가능
  - 데코레이터 패턴
- 인터페이스의 변경
  - 사용하려고 하는 오브젝트가 가진 인터페이스가 클라이언트와 호환되지 않는 경우 유용
  - 어댑터 패턴
- 프록시
  - 필요한 시점에서 실제 사용할 오브젝트를 초기화하고 리소스를 준비하게 해주는 지연된 로딩(lazy loading)을 적용하려면 프록시 필요
  - 프록시 패턴
- 템플릿과 콜백
  - 반복적으로 등장하지만 항상 고정적인 작업 흐름과 그 사이에서 자주 바뀌는 부분을 분리하여 템플릿과 콜백으로 만들고 이를 DI 원리를 응용해 적용하면 코드를 간결하게 만들 수 있음
- 싱글톤과 오브젝트 스코프
  - DI가 필요한 중요한 이유 중 한 가지는 DI 할 오브젝트의 생명 주기를 제어할 수 있다는 것
  - 가장 기본이 되는 스코프는 싱글톤
  - 컨테이너가 알아서 싱글톤을 만들고 관리하기 때문에 클래스 자체는 싱글톤을 고려하지 않고 자유롭게 설계해도 된다는 장점이 있음
- 테스트
  - 여타 오브젝트와 협력해서 동작하는 오브젝트를 효과적으로 테스트하는 방법은 가능한 한 고립시키는 것
  - 의존 오브젝트를 대신해서 스텁 또는 목 오브젝트 같은 테스트 대역을 사용해야 하는데, 이때도 DI는 중요한 역할을 함

## 8.4.2 애스펙트 지향 프로그래밍(AOP)

애스펙트 지향 프로그래밍은 객체지향 프로그래밍(OOP)처럼 독립적인 프로그래밍 패러다임이 아니다. (서로 배타적이지 않다)  
객체지향 기술은 매우 성공적인 프로그래밍 방식임은 분명하나 점점 복잡해져 가는 애플리케이션의 요구 조건과 기술적인 난해함을 모두 해결하는 데 한계가 있기도 하다.  
**AOP는 바로 이러한 객체지향 기술의 한계와 단점을 극복하도록 도와주는 보조적인 프로그래밍 기술**이다.  
스프링의 AOP는 스프링이 POJO 프로그래밍을 지원하려는 그 핵심 목적을 위해 중요한 역할을 하고 있다.

### AOP의 적용 기법

AOP를 자바 언어에 적용하는 기법은 크게 두 가지로 분류할 수 있다.

- 스프링과 같이 다이내믹 프록시를 사용하는 방법
  - 데코레이터 패턴을 응용한 것
  - 인터페이스와 DI를 활용하는 데코레이터 패턴이 기반 원리이기 때문에 부가 기능을 부여할 수 있는 곳은 메서드의 호출이 일어나는 지점뿐이라는 제약이 있음
- 자바 언어의 한계를 넘어서는 언어의 확장을 이용하는 방법
  - 강력한 고급 기능을 가진 AspectJ라는 유명한 오픈소스 AOP 툴 이용
  - 메서드 호출뿐 아니라 인스턴스 생성, 필드 액세스, 특정 호출 경로를 가진 메서드 호출 등에도 부가 기능 제공 가능
