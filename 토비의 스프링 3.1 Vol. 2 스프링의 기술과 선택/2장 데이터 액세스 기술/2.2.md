# 2.2 JDBC

`JDBC`는 자바의 데이터 액세스 기술의 기본이 되는 로우레 벨의 API다.  
JDBC는 표준 인터페이스를 제공하고 각 DB 벤더와 개발팀에서 이 인터페이스를 구현한 드라이버를 제공하는 방식으로 사용된다.

스프링 JDBC는 JDBC 개발의 장점과 단순성을 그대로 유지하면서도 기존 JDBC API 사용 방법의 단점을 템플릿/콜백 패턴을 이용해 극복할 수 있게 해주고, 가장 간결한 형태의 API의 사용법을 제공하며, JDBC API의 사용 방법과 동작 원리를 익혀야 한다는 부담이 있지만 한번 익숙해지면 웬만한 최신 데이터 액세스 기술 못지않은 생산성과 안정성을 확보할 수 있고, 동시에 JDBC가 제공하는 모든 기능을 100% 활용할 수 있다.

## 2.2.1 스프링 JDBC 기술과 동작 원리

### 스프링의 JDBC 접근 방법

스프링 JDBC의 접근 방법 중에서 가장 사용하기 편하고 자주 이용되는 것은 다음 두 가지다.

- SimpleJdbcTemplate
  - JdbcTemplate과 NamedParameterJdbcTemplate에서 가장 많이 사용되는 기능을 통합하고 자바 5 이상의 장점을 최대한 활용할 수 있게 만든 클래스
  - 방대한 템플릿 메서드와 내장된 콜백을 제공하며, JDBC의 모든 기능을 최대한 활용할 수 있는 유연성을 가지고 있음
- SimpleJdbcInsert, SimpleJdbcCall
  - DB가 제공해 주는 메타 정보를 활용해서 최소한의 코드만으로 단순한 JDBC 코드를 작성하게 해줌
  - 메타 정보에서 칼럼 정보와 파라미터 정보를 가져와서 삽입용 SQL과 프로시저 호출 작업에 사용해 주기 때문에 매우 편리함

### 스프링 JDBC가 해주는 작업

스프링 JDBC를 이용하면 다음과 같은 작업을 템플릿이나 스프링 JDBC가 제공하는 오브젝트에게 맡길 수 있다.  
JDBC 프로그래밍에서 반복적으로 등장하는 판에 박힌 작업들이다.

- Connection 열기와 닫기
  - Connection과 관련된 작업은 스프링 JDBC가 필요한 시점에서 알아서 진행해 줌
  - 진행 중에 예외가 발생했을 때에도 문제없이 열린 모든 Connection 오브젝트를 닫아줌
- Statement 준비와 닫기
  - SQL 정보가 담긴 Statement 또는 PreparedStatement를 생성하고 필요한 준비 작업을 처리해 줌
  - 사용이 끝나면 스프링 JDBC가 알아서 반환해 줌
- Statement 실행
  - SQL이 담긴 Statement를 실행해 줌
- ResultSet 루프
  - ResultSet에 담긴 쿼리 실행 결과가 한 건 이상이라면 루프를 돌면서 각각의 로우를 처리해 줘야 하는데, 루프를 만들어 반복해 주는 작업을 처리해 줌
- 예외 처리와 변환
  - JDBC 작업 중 발생하는 모든 예외는 스프링 JDBC의 예외 변환기가 처리해 줌
  - 체크 예외인 SQLException을 런타임 예외인 DataAccessException 타입으로 변환해 줌
  - DB 별 에러 코드를 참고해서 일관된 의미를 가진 DataAccessException 계층 구조 내의 예외로 변환해 줌
- 트랜잭션 처리
  - 트랜잭션을 시작한 후에 스프링 JDBC의 작업을 요청하면 진행 중인 트랜잭션에 참여함
  - 트랜잭션이 없는 채로 호출될 경우 새로운 트랜잭션을 만들어서 사용하고 작업을 마치면 트랜잭션을 종료함
