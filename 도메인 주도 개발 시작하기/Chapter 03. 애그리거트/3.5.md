# 3.5 애그리거트 간 집합 연관

애그리거트 간 1-N과 M-N 연관은 컬렉션(Collection)을 이용한 연관이다.  
카테고리와 상품 간의 연관이 대표적이다.  
카테고리 입장에서 한 카테고리에 한 개 이상의 상품이 속할 수 있으니 카테고리와 상품은 1-N 관계이다.  
한 상품이 한 카테고리에만 속할 수 있다면 상품과 카테고리의 관계는 N-1 관계이다.

애그리거트 간 1-N 관계는 Set과 같은 컬렉션을 이용해서 표현할 수 있다.  
하지만 개념적으로는 애그리거트 간에 1-N 연관이 있더라도 성능 문제 때문에 애그리거트 간의 1-N 연관을 실제 구현에 반영하지 않는다.  
카테고리에 속한 상품을 구할 필요가 있다면 상품 입장에서 자신이 속한 카테고리를 N-1로 연관 지어 구하면 된다.

M-N 연관은 개념적으로 양쪽 애그리거트에 컬렉션으로 연관을 만든다.  
상품이 여러 카테고리에 속할 수 있다고 가정하면 카테고리와 상품은 M-N 연관을 맺는다.  
앞서 1-N 연관처럼 M-N 연관도 실제 요구사항을 고려하여 M-N 연관을 구현에 포함시킬지를 결정해야 한다.

보통 특정 카테고리에 속한 상품 목록을 보여줄 때 목록 화면에서 각 상품이 속한 모든 카테고리를 상품 정보에 표시하지는 않는다.  
상품이 속한 모든 카테고리가 필요한 화면은 상품 상세 화면이다.  
이러한 요구사항을 고려할 때 카테고리에서 상품으로의 집합 연관은 필요하지 않다.  
즉 개념적으로는 상품과 카테고리의 양방향 M-N 연관이 존재하지만 실제 구현에서는 상품에서 카테고리로의 단방향 M-N 연관만 적용하면 되는 것이다.  
RDBMS를 이용해서 M-N 연관을 구현하려면 조인 테이블을 사용한다.
