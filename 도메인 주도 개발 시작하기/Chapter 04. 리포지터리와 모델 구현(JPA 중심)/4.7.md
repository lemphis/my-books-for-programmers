# 4.7 도메인 구현과 DIP

DIP에 따르면 @Entity, @Table은 구현 기술에 속하므로 도메인 모델은 구현 기술인 JPA에 의존하지 말아야 한다.

리포지터리 인터페이스도 마찬가지로 구현 기술은 스프링 데이터 JPA의 Repository 인터페이스를 상속하면 안 된다.  
구현 기술에 대한 의존 없이 도메인을 순수하게 유지하려면 스프링 데이터 JPA의 Repository 인터페이스를 상속받지 않도록 수정하고, 수정한 인터페이스를 구현한 클래스를 인프라에 위치시켜야 한다.  
또한 @Entity, @Table과 같이 JPA에 특화된 애너테이션을 모두 지우고 인프라에 JPA를 연동하기 위한 클래스를 추가해야 한다.

DIP를 적용하는 주된 이유는 **저수준 구현이 변경되더라도 고수준이 영향을 받지 않도록 하기 위함**이다.  
하지만 **리포지터리와 도메인 모델의 구현 기술은 거의 바뀌지 않는다**.  
이렇게 변경이 거의 없는 상황에서 변경을 미리 대비하는 것은 과하다고 생각한다.

JPA 전용 애너테이션을 사용하긴 했지만 도메인 모델을 단위 테스트하는 데 문제는 없다.  
물론 JPA에 맞춰 도메인 모델을 구현해야 할 때도 있지만 이런 상황은 드물다.  
리포지터리도 마찬가지로 스프링 데이터 JPA가 제공하는 Repository 인터페이스를 상속하고 있지만 리포지터리 자체는 인터페이스이고 테스트 가능성을 해치지 않는다.
